// GENERATED BY CURSOR (strict) â€” changed Phase 1 on 2025-09-30. ASSUMPTION: Reads controller state.

import 'package:flutter/material.dart';
import 'package:go_router/go_router.dart';

import '../../core/theme/app_colors.dart';
import '../../providers/subscription_provider.dart';

class PaymentResultScreen extends StatelessWidget {
  const PaymentResultScreen({super.key});

  @override
  Widget build(BuildContext context) {
    final sub = SubscriptionController.instance;
    final success = sub.status == PaymentStatus.success;
    return Material(
      color: const Color.fromARGB(255, 255, 255, 255),
      child: SafeArea(
        child: Center(
        child: Padding(
          padding: const EdgeInsets.all(24),
          child: Column(
            mainAxisSize: MainAxisSize.min,
            children: [
              Icon(success ? Icons.check_circle : Icons.error, size: 72,
                  color: success ? AppColors.success : AppColors.error),
              const SizedBox(height: 12),
              Text(sub.lastMessage ?? (success ? 'Payment successful' : 'Payment failed')),
              const SizedBox(height: 16),
              if (sub.lastOrderId != null) ...[
                Text('Order ID: ${sub.lastOrderId}'),
                const SizedBox(height: 8),
                FilledButton.tonal(
                  onPressed: () async {
                    try {
                      // TODO_BACKEND: Replace with real invoice generation and download
                      // For now, simulate file download
                      await Future.delayed(const Duration(milliseconds: 500));
                      if (context.mounted) {
                        ScaffoldMessenger.of(context).showSnackBar(
                          const SnackBar(
                            content: Text('Invoice downloaded successfully'),
                            backgroundColor: AppColors.success,
                          ),
                        );
                      }
                    } catch (e) {
                      if (context.mounted) {
                        ScaffoldMessenger.of(context).showSnackBar(
                          const SnackBar(
                            content: Text('Failed to download invoice'),
                            backgroundColor: AppColors.error,
                          ),
                        );
                      }
                    }
                  },
                  child: const Text('Download invoice'),
                ),
                const SizedBox(height: 16),
              ],
              FilledButton(
                onPressed: () => context.go('/dashboard/subscription'),
                child: const Text('Back to overview'),
              ),
            ],
          ),
        ),
      ),
    ));
  }
}


